# require-modules-from-pmr-b.sentinel
# This policy validates that all modules loaded directly by the
# root module are in the Private Module Registry (PMR) of a TFC
# organization.

# Import module-functions.sentinel as "modules"
<import_statement>

##### Parameters #####
# The address of the TFC or TFE server
param address default "app.terraform.io"

# The organization on the TFC or TFE server
param organization

# Call the validation function
modules_from_pmr = <function_call>

# Main rule
main = rule {
  modules_from_pmr
}
